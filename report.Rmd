---
title: "Predicting House Prices"
author: "by Danking-team: Yuanchang Zhang, Junzhe Wang"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, include = FALSE}
library(tidyverse)
library(tidymodels)
library(knitr)
library(kableExtra)
library(ggplot2)

```


```{r load-data, include=FALSE}
# load your data here and any pre-processing/cleaning 
#  that you need for your report.
data1 <- read_csv("data/train.csv")


data1 <- data1[, colMeans(is.na(data1)) <= 0.05]


data1_clean <- data1 %>% drop_na()


numeric_vars <- data1_clean %>% select(where(is.numeric))


cor_matrix <- cor(numeric_vars, use = "complete.obs")

top5_cor <- cor_matrix %>%
  as.data.frame.table() %>%
  filter(Var2 == "SalePrice",
         Var1 != "SalePrice") %>%
  mutate(abs_cor = abs(Freq)) %>%
  arrange(desc(abs_cor)) %>%
  head(5)

top_vars <- as.character(top5_cor$Var1)


data_model <- data1_clean %>%
  select(SalePrice, all_of(top_vars))


set.seed(28)
data_split <- initial_split(data_model, prop = 0.8)
data_train <- training(data_split)
data_test  <- testing(data_split)


```


## Research Question

This section presents the main results of our investigation into the factors that drive house prices and the performance of the prediction model we developed. The goal of this analysis was not only to produce predictions of house prices but also to understand which property characteristics contribute most strongly to variations in SalePrice. The following discussion summarises our data cleaning, variable selection, model building, model evaluation, and final interpretation of the results.

1. Data Preparation and Selection of Key Predictors

The original dataset contained a large number of variables describing the characteristics of residential homes in Ames, Iowa. To prepare the data for modelling, we first removed variables with more than 5% missing values. This step ensured that no predictor included in the model relied heavily on imputed or estimated values. After this filtering, we removed all remaining rows with any missing values, leaving a complete dataset suitable for regression modelling.

Next, we identified the variables most strongly related to SalePrice. To do this, we calculated correlations between SalePrice and all numeric variables in the dataset. From this analysis, the five predictors with the strongest positive correlations with SalePrice emerged as:

OverallQual (correlation: 0.7867)

GrLivArea (correlation: 0.7111)

GarageCars (correlation: 0.6418)

GarageArea (correlation: 0.6211)

1stFlrSF (correlation: 0.6148)

These values indicate that houses with better quality ratings, larger living spaces, and larger or more functional garages tend to sell for significantly higher prices. The strong association between SalePrice and both OverallQual and GrLivArea also matches what is frequently reported in housing market analyses, reinforcing the validity of our variable selection. Together, these five predictors form a reasonable and interpretable basis for developing a statistical model.

2. Visual Relationships Between Predictors and SalePrice

To explore the relationships between the selected predictors and SalePrice, we created scatterplots with fitted regression lines. These visualisations helped us understand whether the correlations identified earlier were reflected in the raw data.

The scatterplot of OverallQual vs SalePrice showed a steep upward trend, indicating that higher-quality houses sell for substantially more. Although the variable is ordinal rather than continuous, the relationship was still clear: each increase in quality rating corresponded to a substantial jump in price.

The plot of GrLivArea vs SalePrice displayed a strong and nearly linear relationship, with larger homes consistently commanding higher prices. This relationship was one of the most visually convincing patterns in our dataset, with relatively little overlap between smaller and larger homes.

The relationship between GarageCars and SalePrice was also positive, though with greater variability than the previous two predictors. While garage capacity influences value, buyers may differ in how much importance they place on garage features, explaining the wider spread in the plot.

Overall, the scatterplots confirmed that a linear modelling approach was appropriate for these predictors and provided additional confidence in using them to predict SalePrice.

3. Building the Linear Regression Model

Using the five selected predictors, we fitted a linear regression model. The estimated coefficients were:

OverallQual: +25,293.62

GrLivArea: +45.02 per square foot

GarageCars: +13,999.99

GarageArea: +23.62 per square foot

1stFlrSF: +32.96 per square foot

Each coefficient represents the expected change in SalePrice for a one-unit increase in that predictor, holding all other variables constant. Several important points stand out from these results.

First, OverallQual has the largest coefficient, indicating that quality plays an extremely important role in determining house prices. A one-point increase in quality corresponds to an increase of more than $25,000 in predicted sale price, demonstrating how strongly buyers value high-quality features, materials, and craftsmanship.

Second, GrLivArea and 1stFlrSF both show meaningful positive effects on price, reflecting that buyers place significant importance on living space. Although their coefficients are smaller than that of OverallQual, houses typically vary by many hundreds of square feet, so these variables still have substantial influence on final price.

Third, GarageCars has a much larger effect than GarageArea, highlighting that the functional capacity of a garage matters more than its size alone. A garage that fits more vehicles typically reflects greater convenience, storage, or general utility.

Finally, GarageArea, while still positively associated with SalePrice, has the smallest coefficient and the weakest statistical significance (p ≈ 0.056). This suggests that garage size matters but is overshadowed by more influential characteristics such as quality and living space.

4. Model Evaluation: Accuracy and Predictive Power

To assess how well the model predicts house prices, we applied it to a test dataset and computed two key performance metrics:

RMSE = 36,795.13

R² = 0.758

The RMSE represents the model’s average prediction error. An RMSE of approximately $37,000 indicates that, on average, the model’s predictions differ from actual sale prices by around this amount. While this may seem large, it is reasonable relative to the overall price range of the dataset, which spans from below $100,000 to above $500,000.

The R² value of 0.758 shows that the model explains about 75.8% of the variation in sale prices. This is a strong result for a model using only five predictors. It demonstrates that these variables capture most of the essential structure in the data and that the linear model is capable of producing meaningful predictions.

5. Model Diagnostics: Checking Assumptions

To ensure the validity of the model, we examined several diagnostic plots.

The Predicted vs Actual plot showed that the majority of predictions fall close to the 45-degree reference line, meaning the model generally performs well in estimating sale prices. Deviations from the line were more noticeable for very expensive homes, indicating that the model tends to struggle with predicting high-price outliers, which often have unique features not captured by the predictors.

The Residuals vs Fitted plot revealed a slight funnel shape, with residuals spreading out more as predicted values increased. This suggests the presence of heteroscedasticity, meaning the model's errors are larger for more expensive properties. This is common in real estate data, as high-value homes tend to vary more in features that are not included in simple models.

The QQ plot of residuals generally followed a straight line, indicating that the residuals are approximately normally distributed. Slight deviations appeared at the extreme tails, suggesting that the model may slightly overestimate or underestimate prices for the most expensive houses.

Overall, the diagnostic plots indicate that the linear model meets its assumptions reasonably well and is suitable for interpreting the relationships between variables and SalePrice.

6. Interpretation of Results

The results of this analysis highlight that quality and space are the most influential factors in determining house prices. OverallQual emerged as the strongest single predictor, emphasising that buyers prioritise construction quality and finishing. GrLivArea and 1stFlrSF confirmed the importance of living space, reflecting the general preference for larger homes with more usable interior area. Garage-related variables also contributed meaningfully, especially GarageCars, showing that buyers value functional storage and parking options.

These findings align with real-world expectations. Homes that are well-constructed, spacious, and practical tend to sell for higher prices, which supports the model’s validity and the conclusions drawn from the analysis.

7. Conclusion

In conclusion, this project demonstrates that a small set of carefully selected variables can explain a substantial portion of house price variation. The linear regression model performed well, achieving an R² of 0.758 and offering clear insights into the factors that most strongly influence SalePrice. The results show that overall quality, living space, and functional garage capacity play key roles in shaping housing values. Although more sophisticated models could potentially improve predictive accuracy, the current analysis provides a solid and interpretable understanding of what drives house prices.




## References

Kaggle. (2025). Retrieved from https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/data


